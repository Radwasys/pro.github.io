<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>chat app</title>
  
  <!-- HTML -->
  

  
  
</head>

<body>
	<div id="big">
		<button id="rec" onclick="de()" ><img id="q" src="download.png" alt="record"></button>
		
	<input type="text" id="type" placeholder="Type text">
	<button id="btn" > <img id="t" src="send icon.jpg" alt="send"></button>
</div>
<style>
	#t,#q{
			width:40px;
			height:40px;
			border-radius:30px;

		}


		#btn,#rec{
			background-color:white;
			position:absolute;
			border-radius:30px;
			width:50px;
			height:50px;
			outline:none;
			margin-top:450px;


		}

		#btn{
			margin-left:350px;
		}

		#type{
			height:40px;
			width:300px;
			margin-left:50px;
			position:absolute;
			outline:none;
			font-size:20px;
			
		}

		#type,#btn{
			margin-top:450px;
			border-radius:30px;

		}

		#big{
			position:relative;
			margin-left:450px;
			width:400px;
			height:500px;
			margin-top:50px;
			border:black 1px solid;
			
			background-color:black;
		}

		.me{
			
			background-color:#c9c9c9;
			border:0.5px solid black;
			height:30px;
		}

		#ay{
			width:100%;
			outline:none;
			
		}

		#ay::-webkit-media-controls-panel{
			background-color:#c9c9c9;

		}

		@media screen and (max-width: 833px) {

			#big{
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			html{
				
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			body{
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			#rec{
				display:block;
				background-color:white;
				position:absolute;
				border-radius:30px;
				width:50px;
				height:50px;
				outline:none;
				margin-top:130%;
				
			}

			#q,#t{
				width:40px;
				height:40px;
			}

			#type{

				height:50px;
				width:69%;
				margin-left:50px;
				position:absolute;
				outline:none;
				font-size:20px;
				
				border-radius:30px;
				
			}

			#btn{
				background-color:white;
				position:absolute;
				border-radius:30px;
				width:50px;
				height:50px;
				outline:none;
				
				margin-left:84%;
			}

			.me{
				height:40px;
			}


			
		}
		</style>
  <script>
    	var btn = document.getElementById("btn")
		var type = document.getElementById("type")
		var big = document.getElementById("big")
		
		var rec = document.getElementById("rec")
		var array = []


		var ma = big.offsetHeight
		ma = window.innerHeight
		btn.style.marginTop = (ma - 50) + "px"
		type.style.marginTop = (ma - 50) + "px"
		rec.style.marginTop = (ma - 50) + "px"


		btn.addEventListener("click",function() {
			if(type.value == "") {
				alert("write a message")
			} else {

				if(array.length > 13) {
					alert("you have to clear messages first")
					return false
				}

			var mess = document.createElement("div")
			array.push(mess)
			
			big.appendChild(mess)
			mess.classList.add("me")
			mess.innerHTML = 'You:  ' + type.value
			type.value = ""


			
		}
		})

		addEventListener("keypress",function(e) {
			if(e.key === "Enter") {
			if(type.value == "") {
				alert("write a message")
			} else {
				if(array.length > 13) {
					alert("you have to clear messages first")
					return false
					
				}
			var mess = document.createElement("div")
			array.push(mess)
			
			big.appendChild(mess)
			mess.classList.add("me")
			mess.innerHTML = 'You:  ' + type.value
			type.value = ""


		}}
		})

		function de() {
			alert("recording will stop after 3 seconds")
			navigator.mediaDevices.getUserMedia({audio: true})
			.then(stream => {
				var mediaRecorder = new MediaRecorder(stream)
				mediaRecorder.start()
				var mediaChunks = []
				mediaRecorder.addEventListener("dataavailable",function (e) {
					
					mediaChunks.push(e.data)
				})

				mediaRecorder.addEventListener("stop",function () {
					var mediaBlob = new Blob(mediaChunks)
					var url = URL.createObjectURL(mediaBlob)
					var audio = document.createElement("AUDIO")
					audio.src = url
					audio.controls = true
					audio.setAttribute('id','ay')
					big.appendChild(audio)

				})

				setTimeout(function() {
					mediaRecorder.stop()
					
				},3000)
			})
			.catch(error => {
				alert("please allow mic")
			})
		}
  </script>
</body>
</html>
