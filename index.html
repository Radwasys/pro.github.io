<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-emicPicuiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>chat app</title>

</head>

<body>
	<div id="container">
		<button id="recordButton" onclick="recordAudio()" ><img id="micPic" src="download.png" alt="record"></button>
		
	<input type="text" id="typeMessage" placeholder="Type Message">
	<button id="sendButton" > <img id="sendPic" src="send icon.jpg" alt="send"></button>
</div>
<style>
	#sendPic,#micPic{
			width:40px;
			height:40px;
			border-radius:30px;

		}


		#sendButton,#recordButton{
			background-color:white;
			position:absolute;
			border-radius:30px;
			width:50px;
			height:50px;
			outline:none;
			


		}

		#sendButton{
			margin-left:350px;
		}

		#typeMessage{
			height:50px;
			width:300px;
			margin-left:50px;
			position:absolute;
			outline:none;
			font-size:20px;
			
		}

		#typeMessage,#sendButton{
			
			border-radius:30px;

		}

		#container{
			position:relative;
			margin-left:450px;
			width:400px;
			height:600px;
			margin-bottom:0;
			border:black 1px solid;
			
			background-color:black;
		}

		.me{
			
			background-color:#c9c9c9;
			border:0.5px solid black;
			height:30px;
		}

		#ay{
			width:100%;
			outline:none;
			
		}

		#ay::-webkit-media-controls-panel{
			background-color:#c9c9c9;

		}

		@media screen and (max-width: 833px) {

			#container{
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			html{
				
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			body{
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			#recordButton{
				display:block;
				background-color:white;
				position:absolute;
				border-radius:30px;
				width:50px;
				height:50px;
				outline:none;
				margin-top:130%;
				
			}

			#micPic,#sendPic{
				width:40px;
				height:40px;
			}

			#typeMessage{

				height:50px;
				width:69%;
				margin-left:50px;
				position:absolute;
				outline:none;
				font-size:20px;
				
				border-radius:30px;
				
			}

			#sendButton{
				background-color:white;
				position:absolute;
				border-radius:30px;
				width:50px;
				height:50px;
				outline:none;
				
				margin-left:84%;
			}

			.me{
				height:40px;
			}


			
		}
		</style>
  <script>
    	var sendButton = document.getElementById("sendButton")
		var typeMessage = document.getElementById("typeMessage")
		var container = document.getElementById("container")
		
		var recordButton = document.getElementById("recordButton")
		var messages = []


		var height = container.offsetHeight
		
		sendButton.style.marginTop = (height - 50) + "px"
		typeMessage.style.marginTop = (height - 50) + "px"
		recordButton.style.marginTop = (height - 50) + "px"
		


		sendButton.addEventListener("click",function() {
			if(typeMessage.value == "") {
				alert("write a message")
			} else {

				if(messages.length > 13) {
					alert("you have to clear messages first")
					return false
				}

			var newMessage = document.createElement("div")
			messages.push(newMessage)
			
			container.appendChild(newMessage)
			newMessage.classList.add("me")
			newMessage.innerHTML = 'You:  ' + typeMessage.value
			typeMessage.value = ""


			
		}
		})

		addEventListener("keypress",function(e) {
			if(e.key === "Enter") {
			if(typeMessage.value == "") {
				alert("write a message")
			} else {
				if(messages.length > 13) {
					alert("you have to clear messages first")
					return false
					
				}
			var newMessage = document.createElement("div")
			messages.push(newMessage)
			
			container.appendChild(newMessage)
			newMessage.classList.add("me")
			newMessage.innerHTML = 'You:  ' + typeMessage.value
			typeMessage.value = ""


		}}
		})

		function recordAudio() {
			alert("recording will stop after 3 seconds")
			navigator.mediaDevices.getUserMedia({audio: true})
			.then(stream => {
				var mediaRecorder = new MediaRecorder(stream)
				mediaRecorder.start()
				var mediaChunks = []
				mediaRecorder.addEventListener("dataavailable",function (e) {
					
					mediaChunks.push(e.data)
				})

				mediaRecorder.addEventListener("stop",function () {
					var mediaBlob = new Blob(mediaChunks)
					var url = URL.createObjectURL(mediaBlob)
					var audio = document.createElement("AUDIO")
					audio.src = url
					audio.controls = true
					audio.setAttribute('id','ay')
					container.appendChild(audio)

				})

				setTimeout(function() {
					mediaRecorder.stop()
					
				},3000)
			})
			.catch(error => {
				alert("please allow mic")
			})
		}
  </script>
</body>
</html>
