<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-emicPicuiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>chat app</title>

</head>

<body>
	
	<button id="back">BACK</button>
	<div id="container">
		<button id="back2">BACK</button>
		<button id="stop">STOP</button>
		<button id="recordButton" onclick="recordAudio()" ><img id="micPic" src="download.png" alt="record"></button>
		
	<input type="text" id="typeMessage" placeholder="Type Message">
	<button id="sendButton" > <img id="sendPic" src="send icon.jpg" alt="send"></button>

</div>


<div id="homepage">
  <h1>Welcome!</h1>
  <p id="p1">Choose what you would like to identify</p>
  <button id="speech">Speech</button>
  <p id="p2">The app recognizes what is being said <br> and dispalys it on the screen as words</p>
  <button id="sound">Sound</button>
  <p id="p3">Record a sound or a helper on this app <br>and you will recieve a response<br> identifying the sound in a short time</p>
</div>

<style>
	/*styling of audio recognizing page*/
	#sendPic,#micPic{
			width:40px;
			height:40px;
			border-radius:30px;

		}


		#sendButton,#recordButton{
			background-color:white;
			position:absolute;
			border-radius:30px;
			width:50px;
			height:50px;
			outline:none;
			


		}

		#sendButton{
			margin-left:350px;
		}

		#typeMessage{
			height:40px;
			width:300px;
			margin-left:50px;
			position:absolute;
			outline:none;
			font-size:20px;
			
		}

		#typeMessage,#sendButton{
			
			border-radius:30px;

		}

		#container{
			position:relative;
			margin-left:450px;
			width:400px;
			height:600px;
			margin-bottom:0;
			border:black 1px solid;
			display:none;
			background-color:black;
		}

		.me{
			
			background-color:#c9c9c9;
			border:0.5px solid black;
			height:30px;
		}

		#ay{
			width:100%;
			outline:none;
			
		}

		#ay::-webkit-media-controls-panel{
			background-color:#c9c9c9;

		}

		#back{
			position:absolute;
			margin-left:398px;
			background-color:black;
			color:white;
			height:30px;
			border:black solid 1px;
			border-radius:5px 0 0 5px;
			outline:none;
			display:none;
		}



		#back2,#stop{
			display:none;
			background-color:black;
			color:white;
			height:30px;
			border:black solid 1px;
			border-radius:5px 0 0 5px;
			outline:none;
			
		}





		/*styling of homepage*/

		#homepage{
			position:relative;
			margin-left:450px;
			width:400px;
			height:600px;
			margin-bottom:0;
			border:black 1px solid;
			display:block;
			background-color:black;
		}

		h1{
			color:white;
			text-align:center;
		}

		#p1{
			color:#656769;
			text-align:center;
			font-size:20px;
		}

		#speech{
			width:95%;
			height:70px;
			text-align:center;
			border:2px solid white;
			border-radius:30px;
			color:white;
			
			background-color:black;
			outline:none;
			margin-top:50px;
			margin-left:10px;
		}

		#p2,#p3{
			color:#656769;
			text-align:center;

		}

		#sound{
			width:95%;
			height:70px;
			text-align:center;
			border:2px solid white;
			border-radius:30px;
			color:white;
			
			background-color:black;
			outline:none;
			margin-top:85px;
			margin-left:10px;
		}



		@media screen and (max-width: 833px) {

			#container,#homepage{
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			html{
				
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			body{
				width:100%;
				height:100%;
				margin:0 0 0 0;
			}

			#recordButton{
				display:block;
				background-color:white;
				position:absolute;
				border-radius:30px;
				width:50px;
				height:50px;
				outline:none;
				
				
			}

			#micPic,#sendPic{
				width:40px;
				height:40px;
			}

			#typeMessage{

				height:40px;
				width:69%;
				margin-left:50px;
				position:absolute;
				outline:none;
				font-size:20px;
				
				border-radius:30px;
				
			}

			#sendButton{
				background-color:white;
				position:absolute;
				border-radius:30px;
				width:50px;
				height:50px;
				outline:none;
				
				margin-left:84%;
			}

			.me{
				height:40px;

			}

			#back{
				display:none;
			}

			

			h1{
				color:white;
				text-align:center;
			}

			#p1{
				color:#656769;
				text-align:center;
				font-size:20px;
			}

			#speech{
				width:95%;
				height:70px;
				text-align:center;
				border:2px solid white;
				border-radius:30px;
				color:white;
				
				background-color:black;
				outline:none;
				margin-top:50px;
				margin-left:10px;
			}

			#p2,#p3{
				color:#656769;
				text-align:center;

			}

			#sound{
				width:95%;
				height:70px;
				text-align:center;
				border:2px solid white;
				border-radius:30px;
				color:white;
				
				background-color:black;
				outline:none;
				margin-top:85px;
				margin-left:10px;
			}

			#stop{
				margin-left:80%;
				margin-top:-30px;
			}

		}
		</style>
  <script>
    	var sendButton = document.getElementById("sendButton")
		var typeMessage = document.getElementById("typeMessage")
		var container = document.getElementById("container")
		var homepage = document.getElementById("homepage")
		var speech = document.getElementById("speech")
		var back = document.getElementById("back")
		var backt = document.getElementById("back2")
		var recordButton = document.getElementById("recordButton")
		var sound = document.getElementById("sound")
		var stop = document.getElementById("stop")
		var messages = []


		function recordAudio() {
			
			navigator.mediaDevices.getUserMedia({audio: true})
			.then(stream => {
				stop.style.display = 'block'
				var mediaRecorder = new MediaRecorder(stream)
				mediaRecorder.start()
				var mediaChunks = []
				mediaRecorder.addEventListener("dataavailable",function (e) {
					
					mediaChunks.push(e.data)
				})

				mediaRecorder.addEventListener("stop",function () {
					var mediaBlob = new Blob(mediaChunks)
					var url = URL.createObjectURL(mediaBlob)
					var audio = document.createElement("AUDIO")
					messages.push(audio)
					audio.src = url
					audio.controls = true
					audio.setAttribute('id','ay')
					container.appendChild(audio)
					stop.style.display = 'none'

				})

				stop.addEventListener("click", function () {
					mediaRecorder.stop()
				})
			})
			.catch(error => {
				alert("please allow mic")
			})
		}

		

		sendButton.addEventListener("click",function() {
			if(typeMessage.value == "") {
				alert("write a message")
			} else {

				if(messages.length > 13) {
					alert("you have to clear messages first")
					return false
				}

			var newMessage = document.createElement("div")
			messages.push(newMessage)
			
			container.appendChild(newMessage)
			if (window.innerWidth < 818) {
			var mes = messages[0]
				
			mes.style.marginTop = 30 + 'px'
			}
			newMessage.classList.add("me")
			newMessage.innerHTML = 'You:  ' + typeMessage.value
			typeMessage.value = ""


			
		}
		})

		addEventListener("keypress",function(e) {
			if(e.key === "Enter") {
			if(typeMessage.value == "") {
				alert("write a message")
			} else {
				if(messages.length > 13) {
					alert("you have to clear messages first")
					return false
					
				}


			var newMessage = document.createElement("div")
			messages.push(newMessage)
			
			container.appendChild(newMessage)
			newMessage.classList.add("me")
			if (window.innerWidth < 818) {
			var mes = messages[0]
			
			mes.style.marginTop = 10 + 'px'
		}
			newMessage.innerHTML = 'You:  ' + typeMessage.value
			typeMessage.value = ""


		}}
		})


		sound.addEventListener("click", function () {
			homepage.style.display = 'none'
			back.style.display = 'block'
			container.style.display = 'block'


			var height = container.offsetHeight
		
		    sendButton.style.marginTop = (height - 80) + "px"
		    typeMessage.style.marginTop = (height - 80) + "px"
		    recordButton.style.marginTop = (height - 80) + "px"
		    if (window.innerWidth < 818) {
		    	back.style.display = 'none'
		    	backt.style.display = 'block'
		    	

		    }
		    
		})

		back.addEventListener("click", function () {
			homepage.style.display = 'block'
			back.style.display = 'none'
			container.style.display = 'none'
		})

		backt.addEventListener("click", function () {
			homepage.style.display = 'block'

			container.style.display = 'none'
		})

		speech.addEventListener("click", function () {
			alert("This feauture will be added soon")
		})


  </script>
</body>
</html>
